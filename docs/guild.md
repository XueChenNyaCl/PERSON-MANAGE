项目需求总结
1. 项目目标
开发一套务实、易用、可扩展的学校综合管理系统，核心服务于中小学的日常管理需求，包括人事档案、考勤消费、分组评分、评选通知等，通过插件化架构适应不同学校的软硬件环境，并确保低学习成本，让教师、学生、家长都能快速上手。

2. 核心功能需求
模块	功能点	说明
基础数据	学生/教职工档案管理	增删改查，支持Excel导入导出，关联班级/部门
考勤管理	到校/离校记录、课堂考勤	对接刷卡/人脸设备，自动生成记录；教师可手动确认缺勤；异常自动推送到家长端
消费管理	食堂/小卖部消费记录	刷卡/人脸支付，实时记录；家长可查看余额和明细；可设置消费限额
分组管理	班级、年级、学习小组、宿舍	管理员配置基础分组，老师可创建/调整小组
评分体系	个人分、小组分、班级分、宿舍分	支持自定义加减分规则（如迟到扣分、获奖加分）；分数变化实时推送
事件驱动	考勤事件、活动结果触发自动加减分	基于规则引擎，事件与分数自动联动
申诉机制	对分数记录提出异议，管理员审核	学生/教师可提交申诉，附证据；审核结果可撤销或修改分数
评选功能	优秀教职工/小组投票	管理员发起评选，教职工投票，结果实时统计并公示
通知公告	学校公告、班级通知	支持文本+附件，推送至相关端（家长端、一体机）
搜索查询	全局搜索、高级筛选	支持姓名、学号、班级等关键字模糊搜索
家长端	查看孩子考勤、消费、通知	仅接收信息，不与教师直接聊天（避免负担）
一体机端	班级展示（课表、考勤）、学生自助签到/查询	自动登录班级账号，大屏适配，支持刷卡/人脸验证
插件架构	核心+插件模式	各模块作为插件，可独立安装/卸载，第三方可开发新插件
3. 非功能需求
易用性：界面简洁，操作步骤不超过3步，所有功能有明确文字和图标提示。

实时性：分数变化、通知通过WebSocket实时推送到各端。

可扩展性：插件化设计，开放API，方便对接新硬件或新功能。

安全性：基于角色的权限控制（RBAC），敏感数据加密存储。

性能：支持全校数千师生并发使用，数据库查询响应<200ms。

TODO 计划（分阶段任务）
第一阶段：核心基础与最小可用产品（MVP）
目标：搭建前后端基础框架，实现人员管理、考勤、评分、通知基本功能，能在一个班级内试用。

项目初始化：创建Vue + Rust项目，配置开发环境。

数据库设计：设计用户、角色、权限、人员、考勤、分数、通知表。

后端：实现用户认证（JWT）、基础CRUD API（人员、班级）。

前端：搭建登录页、基础布局，实现人员管理页面（列表、新增、编辑）。

考勤模块：对接模拟刷卡设备（或手动录入），记录迟到/缺勤，触发扣分规则。

评分模块：实现分数记录、当前分数聚合API，前端展示个人/小组分数。

通知模块：发布公告，前端列表展示。

WebSocket基础：实现连接建立，推送分数变化。

家长端简单版：仅展示孩子考勤和分数（Web页面，适配手机）。

第二阶段：插件化架构与核心插件完善
目标：实现插件化框架，将各模块拆分为插件，完善评分体系、申诉机制、消费管理。

插件化设计：定义插件接口（Plugin trait），实现插件管理器（动态加载/卸载）。

将人员、考勤、评分、通知等模块重构为独立插件，通过消息总线通信。

评分规则引擎：支持配置加减分规则（如迟到扣1分），规则存储为JSON。

申诉流程：前端申诉表单，后端审核API，分数记录状态管理。

消费管理插件：对接模拟消费设备，记录消费，家长端展示。

评选功能插件：发起投票、投票、结果统计。

搜索优化：实现全文搜索（PostgreSQL tsvector），支持多字段模糊查询。

第三阶段：多端适配与高级功能
目标：开发一体机端、优化家长端体验，增加校历、活动插件，完善事件驱动。

一体机端：开发独立客户端（Electron或浏览器全屏），自动登录班级账号，实现班级看板、学生签到、分数查询。

家长端优化：推送通知（Web Push），增加消费充值功能（可选）。

校历插件：提供学期、周次、节假日信息，可用于周期性评分。

活动插件：录入运动会/比赛结果，自动触发加分。

事件驱动完善：考勤、活动等事件与评分规则完全解耦，支持自定义事件。

数据统计看板：为管理员提供全校数据概览（考勤率、消费排行、评分趋势）。

第四阶段：测试、部署与文档
目标：系统测试，编写文档，准备上线。

单元测试与集成测试（后端Rust测试，前端组件测试）。

性能测试，优化数据库索引和查询。

编写用户手册（图文）、管理员部署指南。

Docker化部署，提供docker-compose.yml。

开放插件开发文档，示例插件。

开发文件目录规划
text
school-management-system/
├── frontend/                     # 前端项目（Vue 3 + TypeScript）
│   ├── public/
│   ├── src/
│   │   ├── api/                  # 与后端通信（按模块拆分）
│   │   │   ├── auth.ts
│   │   │   ├── user.ts
│   │   │   ├── attendance.ts
│   │   │   ├── score.ts
│   │   │   └── ...
│   │   ├── assets/               # 静态资源
│   │   ├── components/            # 公共组件
│   │   │   ├── layout/            # 布局组件（侧栏、头部）
│   │   │   ├── common/            # 通用组件（按钮、卡片、表格）
│   │   │   └── ...
│   │   ├── composables/           # 组合式函数（如useWebSocket）
│   │   ├── router/                # 路由配置
│   │   ├── stores/                # Pinia状态管理
│   │   │   ├── user.ts
│   │   │   ├── score.ts
│   │   │   └── ...
│   │   ├── styles/                # 全局样式（CSS变量、重置）
│   │   ├── types/                  # TypeScript类型定义
│   │   ├── utils/                  # 工具函数
│   │   ├── views/                  # 页面组件
│   │   │   ├── Dashboard.vue
│   │   │   ├── PersonList.vue
│   │   │   ├── Attendance.vue
│   │   │   ├── ScoreBoard.vue
│   │   │   ├── Notice.vue
│   │   │   └── ...
│   │   ├── App.vue
│   │   ├── main.ts
│   │   └── vite-env.d.ts
│   ├── index.html
│   ├── package.json
│   ├── tsconfig.json
│   └── vite.config.ts
│
├── backend/                       # 后端项目（Rust + Axum）
│   ├── Cargo.toml
│   ├── Cargo.lock
│   ├── .env.example
│   ├── src/
│   │   ├── main.rs                # 应用入口
│   │   ├── lib.rs                  # 库入口
│   │   ├── core/                   # 核心基础
│   │   │   ├── mod.rs
│   │   │   ├── config.rs           # 配置加载
│   │   │   ├── error.rs            # 统一错误处理
│   │   │   ├── db.rs                # 数据库连接
│   │   │   ├── auth.rs              # JWT认证
│   │   │   └── plugin.rs            # 插件管理器定义
│   │   ├── models/                  # 数据模型
│   │   │   ├── mod.rs
│   │   │   ├── user.rs
│   │   │   ├── person.rs
│   │   │   ├── attendance.rs
│   │   │   ├── score.rs
│   │   │   └── ...
│   │   ├── api/                     # HTTP API路由
│   │   │   ├── mod.rs
│   │   │   ├── auth.rs
│   │   │   ├── person.rs
│   │   │   ├── attendance.rs
│   │   │   └── ...
│   │   ├── ws/                       # WebSocket处理
│   │   │   ├── mod.rs
│   │   │   └── handler.rs
│   │   ├── plugins/                  # 内置插件
│   │   │   ├── mod.rs
│   │   │   ├── attendance_plugin.rs
│   │   │   ├── score_plugin.rs
│   │   │   ├── notice_plugin.rs
│   │   │   └── ...
│   │   └── utils/                     # 工具函数
│   │       ├── mod.rs
│   │       └── rule_engine.rs         # 规则引擎
│   ├── migrations/                     # 数据库迁移（SQL）
│   └── tests/                          # 集成测试
│
├── docs/                               # 项目文档
│   ├── requirements.md                  # 需求文档
│   ├── api.md                           # API文档
│   ├── plugin-dev.md                     # 插件开发指南
│   └── user-manual/                      # 用户手册
│
├── scripts/                             # 辅助脚本
│   ├── init-db.sh
│   └── build.sh
│
├── docker-compose.yml                    # Docker编排
├── .gitignore
└── README.md
说明：

前后端分离，前端使用Vite构建，后端使用Axum框架。

插件位于 backend/src/plugins/，每个插件实现 Plugin trait，并通过插件管理器加载。

数据库迁移使用 sqlx 的离线迁移功能，迁移文件放在 migrations/ 目录。

所有模块按业务划分，保持高内聚低耦合。